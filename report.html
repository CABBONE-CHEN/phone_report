<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=1024, user-scalable=yes">
    <title>iPhone 验机报告</title>
    <style>
        * { box-sizing: border-box; }
        body {
            font-family: "SF Pro Display", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Inter", "Helvetica Neue", Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
            line-height: 1.4;
            background-color: #f5f5f7;
            color: #1d1d1f;
            margin: 0;
            padding: 15px;
        }
        #report-container {
            max-width: 900px;
            margin: 20px auto;
            background-color: #ffffff;
            border: 1px solid #d2d2d7;
            box-shadow: 0 4px 16px rgba(0,0,0,0.08);
            border-radius: 12px;
            overflow: hidden;
        }
        .header {
            padding: 24px;
            background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
            text-align: center;
            color: white;
        }
        .header h1 {
            font-size: 28px;
            font-weight: 800;
            margin: 0 0 6px 0;
        }
        .header .subtitle {
            font-size: 14px;
            opacity: 0.8;
        }
        .lang-switcher {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-top: 16px;
        }
        .lang-btn {
            background-color: rgba(255,255,255,0.2);
            color: white;
            border: 1px solid rgba(255,255,255,0.3);
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .lang-btn:hover, .lang-btn.active {
            background-color: rgba(255,255,255,0.3);
        }
        .content {
            padding: 24px 32px;
        }
        h2 {
            font-size: 20px;
            font-weight: 700;
            color: #1d1d1f;
            margin: 24px 0 12px 0;
            padding-bottom: 8px;
            border-bottom: 2px solid #f5f5f7;
        }
        .info-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 16px;
        }
        .info-table td {
            padding: 12px 16px;
            border-bottom: 1px solid #f0f0f0;
        }
        .info-table td:first-child {
            font-weight: 600;
            color: #515154;
            width: 40%;
        }
        .info-table td:last-child {
            color: #1d1d1f;
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }
        .test-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 12px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .test-item .label {
            font-weight: 500;
            color: #515154;
        }
        .test-item .status {
            font-weight: 600;
            color: #059669;
        }
        .test-item .status::before {
            content: "✓ ";
        }
        .battery-section {
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
        }
        .battery-health {
            font-size: 48px;
            font-weight: 800;
            color: #059669;
            text-align: center;
        }
        .battery-label {
            text-align: center;
            color: #065f46;
            font-weight: 600;
        }
        .conclusion {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            border-radius: 8px;
            padding: 16px;
            margin: 24px 0;
        }
        .conclusion h3 {
            color: #1e40af;
            margin: 0 0 8px 0;
        }
        .conclusion p {
            color: #1e3a8a;
            margin: 0;
        }
        .footer {
            padding: 16px 32px;
            background-color: #fafafa;
            border-top: 1px solid #e5e5e7;
            text-align: center;
            font-size: 12px;
            color: #86868b;
        }
        .disclaimer {
            margin-top: 24px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 6px;
            font-size: 12px;
            color: #6b7280;
        }
        .error-container {
            text-align: center;
            padding: 60px 20px;
        }
        .error-container h2 {
            color: #dc2626;
            border: none;
        }
        .error-container p {
            color: #6b7280;
        }
        .error-container a {
            color: #1e3a8a;
        }
        @media (max-width: 768px) {
            .test-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        @media (max-width: 480px) {
            .test-grid {
                grid-template-columns: 1fr;
            }
            .content {
                padding: 16px 20px;
            }
        }
    </style>
</head>
<body>
    <div id="report-container">
        <div class="header">
            <h1 data-i18n="title">iPhone 验机报告</h1>
            <div class="subtitle" data-i18n="subtitle">专业设备检测与评估</div>
            <div class="lang-switcher">
                <button class="lang-btn active" data-lang="zh">中文</button>
                <button class="lang-btn" data-lang="en">English</button>
                <button class="lang-btn" data-lang="es">Español</button>
            </div>
        </div>

        <div class="content" id="reportContent">
            <!-- 动态内容将在这里生成 -->
            <div class="error-container" id="loadingState">
                <h2>加载中...</h2>
            </div>
        </div>

        <div class="footer">
            <p data-i18n="reportTime">报告生成时间</p>: <span id="reportTime"></span>
        </div>
    </div>

    <script>
        // 多语言翻译
        const i18n = {
            zh: {
                title: 'iPhone 验机报告',
                subtitle: '专业设备检测与评估',
                basicInfo: '基本信息',
                model: '型号',
                storage: '存储容量',
                serial: '序列号',
                imei: 'IMEI',
                imei2: 'IMEI 2',
                systemInfo: '系统信息',
                iosVersion: 'iOS 版本',
                activationStatus: '激活状态',
                activated: '已激活',
                hardwareTest: '硬件检测',
                display: '显示屏',
                touchScreen: '触控屏',
                faceId: 'Face ID',
                rearCamera: '后置摄像头',
                frontCamera: '前置摄像头',
                speaker: '扬声器',
                microphone: '麦克风',
                wifi: 'WiFi',
                bluetooth: '蓝牙',
                cellular: '蜂窝网络',
                gps: 'GPS',
                charging: '充电功能',
                buttons: '物理按键',
                vibrator: '振动马达',
                sensors: '传感器',
                normal: '正常',
                battery: '电池',
                batteryHealth: '电池健康度',
                cycleCount: '充电循环次数',
                originalParts: '原装配件',
                yes: '是',
                displayOriginal: '显示屏原装',
                batteryOriginal: '电池原装',
                conclusion: '检测结论',
                conclusionText: '该设备经检测，各项功能正常，硬件状态良好。',
                reportTime: '报告生成时间',
                disclaimer: '免责声明',
                disclaimerText: '本报告基于设备当前状态生成，仅供参考。',
                notFound: '未找到设备',
                notFoundDesc: '请检查链接是否正确，或返回首页重新查询。',
                backHome: '返回首页'
            },
            en: {
                title: 'iPhone Inspection Report',
                subtitle: 'Professional Device Diagnostics',
                basicInfo: 'Basic Information',
                model: 'Model',
                storage: 'Storage',
                serial: 'Serial Number',
                imei: 'IMEI',
                imei2: 'IMEI 2',
                systemInfo: 'System Information',
                iosVersion: 'iOS Version',
                activationStatus: 'Activation Status',
                activated: 'Activated',
                hardwareTest: 'Hardware Test',
                display: 'Display',
                touchScreen: 'Touch Screen',
                faceId: 'Face ID',
                rearCamera: 'Rear Camera',
                frontCamera: 'Front Camera',
                speaker: 'Speaker',
                microphone: 'Microphone',
                wifi: 'WiFi',
                bluetooth: 'Bluetooth',
                cellular: 'Cellular',
                gps: 'GPS',
                charging: 'Charging',
                buttons: 'Physical Buttons',
                vibrator: 'Vibration Motor',
                sensors: 'Sensors',
                normal: 'Normal',
                battery: 'Battery',
                batteryHealth: 'Battery Health',
                cycleCount: 'Cycle Count',
                originalParts: 'Original Parts',
                yes: 'Yes',
                displayOriginal: 'Original Display',
                batteryOriginal: 'Original Battery',
                conclusion: 'Conclusion',
                conclusionText: 'This device has been tested and all functions are working properly.',
                reportTime: 'Report Generated',
                disclaimer: 'Disclaimer',
                disclaimerText: 'This report is based on the current state of the device and is for reference only.',
                notFound: 'Device Not Found',
                notFoundDesc: 'Please check the link or go back to search again.',
                backHome: 'Back to Home'
            },
            es: {
                title: 'Informe de Inspección iPhone',
                subtitle: 'Diagnóstico Profesional de Dispositivos',
                basicInfo: 'Información Básica',
                model: 'Modelo',
                storage: 'Almacenamiento',
                serial: 'Número de Serie',
                imei: 'IMEI',
                imei2: 'IMEI 2',
                systemInfo: 'Información del Sistema',
                iosVersion: 'Versión iOS',
                activationStatus: 'Estado de Activación',
                activated: 'Activado',
                hardwareTest: 'Prueba de Hardware',
                display: 'Pantalla',
                touchScreen: 'Pantalla Táctil',
                faceId: 'Face ID',
                rearCamera: 'Cámara Trasera',
                frontCamera: 'Cámara Frontal',
                speaker: 'Altavoz',
                microphone: 'Micrófono',
                wifi: 'WiFi',
                bluetooth: 'Bluetooth',
                cellular: 'Red Celular',
                gps: 'GPS',
                charging: 'Carga',
                buttons: 'Botones Físicos',
                vibrator: 'Motor de Vibración',
                sensors: 'Sensores',
                normal: 'Normal',
                battery: 'Batería',
                batteryHealth: 'Salud de Batería',
                cycleCount: 'Ciclos de Carga',
                originalParts: 'Piezas Originales',
                yes: 'Sí',
                displayOriginal: 'Pantalla Original',
                batteryOriginal: 'Batería Original',
                conclusion: 'Conclusión',
                conclusionText: 'Este dispositivo ha sido probado y todas las funciones funcionan correctamente.',
                reportTime: 'Informe Generado',
                disclaimer: 'Aviso Legal',
                disclaimerText: 'Este informe se basa en el estado actual del dispositivo y es solo para referencia.',
                notFound: 'Dispositivo No Encontrado',
                notFoundDesc: 'Verifique el enlace o regrese para buscar nuevamente.',
                backHome: 'Volver al Inicio'
            }
        };

        let currentLang = 'es';
        let deviceData = null;

        // 获取 URL 参数
        function getQueryParam(name) {
            const params = new URLSearchParams(window.location.search);
            return params.get(name);
        }

        // 翻译函数
        function t(key) {
            return i18n[currentLang][key] || i18n['en'][key] || key;
        }

        // 切换语言
        function switchLanguage(lang) {
            currentLang = lang;
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.lang === lang);
            });
            if (deviceData) {
                renderReport(deviceData);
            }
            updateStaticTexts();
        }

        // 更新静态文本
        function updateStaticTexts() {
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.dataset.i18n;
                if (i18n[currentLang][key]) {
                    el.textContent = i18n[currentLang][key];
                }
            });
        }

        // 生成报告内容
        function renderReport(device) {
            const content = document.getElementById('reportContent');
            const batteryHealth = 85 + Math.floor(Math.random() * 16); // 85-100%
            const cycleCount = Math.floor(Math.random() * 200) + 50;

            content.innerHTML = `
                <!-- 基本信息 -->
                <h2>${t('basicInfo')}</h2>
                <table class="info-table">
                    <tr><td>${t('model')}</td><td>${device.model_display}</td></tr>
                    <tr><td>${t('storage')}</td><td>${device.storage}</td></tr>
                    <tr><td>${t('serial')}</td><td>${device.serial}</td></tr>
                    <tr><td>${t('imei')}</td><td>${device.imei1}</td></tr>
                    ${device.imei2 ? `<tr><td>${t('imei2')}</td><td>${device.imei2}</td></tr>` : ''}
                </table>

                <!-- 系统信息 -->
                <h2>${t('systemInfo')}</h2>
                <table class="info-table">
                    <tr><td>${t('iosVersion')}</td><td>iOS 18.2</td></tr>
                    <tr><td>${t('activationStatus')}</td><td>${t('activated')}</td></tr>
                </table>

                <!-- 硬件检测 -->
                <h2>${t('hardwareTest')}</h2>
                <div class="test-grid">
                    <div class="test-item"><span class="label">${t('display')}</span><span class="status">${t('normal')}</span></div>
                    <div class="test-item"><span class="label">${t('touchScreen')}</span><span class="status">${t('normal')}</span></div>
                    <div class="test-item"><span class="label">${t('faceId')}</span><span class="status">${t('normal')}</span></div>
                    <div class="test-item"><span class="label">${t('rearCamera')}</span><span class="status">${t('normal')}</span></div>
                    <div class="test-item"><span class="label">${t('frontCamera')}</span><span class="status">${t('normal')}</span></div>
                    <div class="test-item"><span class="label">${t('speaker')}</span><span class="status">${t('normal')}</span></div>
                    <div class="test-item"><span class="label">${t('microphone')}</span><span class="status">${t('normal')}</span></div>
                    <div class="test-item"><span class="label">${t('wifi')}</span><span class="status">${t('normal')}</span></div>
                    <div class="test-item"><span class="label">${t('bluetooth')}</span><span class="status">${t('normal')}</span></div>
                    <div class="test-item"><span class="label">${t('cellular')}</span><span class="status">${t('normal')}</span></div>
                    <div class="test-item"><span class="label">${t('gps')}</span><span class="status">${t('normal')}</span></div>
                    <div class="test-item"><span class="label">${t('charging')}</span><span class="status">${t('normal')}</span></div>
                    <div class="test-item"><span class="label">${t('buttons')}</span><span class="status">${t('normal')}</span></div>
                    <div class="test-item"><span class="label">${t('vibrator')}</span><span class="status">${t('normal')}</span></div>
                    <div class="test-item"><span class="label">${t('sensors')}</span><span class="status">${t('normal')}</span></div>
                </div>

                <!-- 电池信息 -->
                <h2>${t('battery')}</h2>
                <div class="battery-section">
                    <div class="battery-health">${batteryHealth}%</div>
                    <div class="battery-label">${t('batteryHealth')}</div>
                </div>
                <table class="info-table">
                    <tr><td>${t('cycleCount')}</td><td>${cycleCount}</td></tr>
                    <tr><td>${t('batteryOriginal')}</td><td>${t('yes')}</td></tr>
                </table>

                <!-- 原装配件 -->
                <h2>${t('originalParts')}</h2>
                <table class="info-table">
                    <tr><td>${t('displayOriginal')}</td><td>${t('yes')}</td></tr>
                    <tr><td>${t('batteryOriginal')}</td><td>${t('yes')}</td></tr>
                </table>

                <!-- 检测结论 -->
                <div class="conclusion">
                    <h3>${t('conclusion')}</h3>
                    <p>${t('conclusionText')}</p>
                </div>

                <!-- 免责声明 -->
                <div class="disclaimer">
                    <strong>${t('disclaimer')}:</strong> ${t('disclaimerText')}
                </div>
            `;
        }

        // 显示错误
        function showError() {
            const content = document.getElementById('reportContent');
            content.innerHTML = `
                <div class="error-container">
                    <h2>${t('notFound')}</h2>
                    <p>${t('notFoundDesc')}</p>
                    <p><a href="index.html">${t('backHome')}</a></p>
                </div>
            `;
        }

        // 初始化
        async function init() {
            // 绑定语言切换
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    switchLanguage(this.dataset.lang);
                });
            });

            // 获取设备标识
            const serial = getQueryParam('serial');
            const imei = getQueryParam('imei');

            if (!serial && !imei) {
                switchLanguage('es');
                showError();
                return;
            }

            // 加载设备索引
            try {
                const response = await fetch('device_index.json');
                const index = await response.json();

                // 查找设备
                let device = null;
                for (const [key, dev] of Object.entries(index.devices)) {
                    if ((serial && dev.serial === serial) ||
                        (imei && (dev.imei1 === imei || dev.imei2 === imei))) {
                        device = dev;
                        break;
                    }
                }

                if (device) {
                    deviceData = device;
                    switchLanguage('es');
                    renderReport(device);
                    document.getElementById('reportTime').textContent = new Date().toLocaleString('es-ES');
                } else {
                    switchLanguage('es');
                    showError();
                }
            } catch (error) {
                console.error('Error loading device index:', error);
                switchLanguage('es');
                showError();
            }
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
